<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkbinance</title>
    <link rel="stylesheet" href="css/zero_style.css">
    <link rel="stylesheet" href="css/index_styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oxygen:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script>
        $(document).ready(function() {
            const formHandler = function (form) {
                const data = {
                    symbols : $("#symbols").val()
                }
                $.getJSON('/ticker/lastprice', data)
                    .done(function(response) {
                    console.log(response)
                    const target = $("#table"); target.empty()
                    for (let i = 0; i < response.length; i++) {
                        let table_element = $("<div>", { id : response[i].id, "class" : "tiker"})

                        let tiker_name = $("<div>", {"class" : "tiker_name tiker_params"})
                        $("<p>" + response[i].symbol + "</p>").appendTo(tiker_name)
                        table_element.append(tiker_name)

                        let tiker_price = $("<div>", {"class" : "tiker_price tiker_params"})
                        $("<p>" + "price: " +response[i].price + "</p>").appendTo(tiker_price)
                        table_element.append(tiker_price)

                        let subscribe_button = $("<div>", {"class" : "subscribe_button tiker_params"})
                        $("<a href='#'>subscribe</a>").appendTo(subscribe_button)
                        table_element.append(subscribe_button)

                        target.append(table_element)
                    }
                }).fail(function( jqxhr, textStatus, error ) {
                    var err = textStatus + ", " + error;
                    console.log( "Request Failed: " + err );
                    alert("Request Failed: " + err +"try other ticker names")
                });
            }

            $('#myForm').validate({
                submitHandler : formHandler
            })
        });
    </script>
</head>

<body>
    <header>
        <div class="header_container">
            <h1>Checkbinance</h1>
            <div class="nav">
                <div class="nav_link">
                    <a href="#">home</a>
                </div>
                <div class="nav_link">
                    <a href="#">subscribes</a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <form id="myForm">
            <button>Refresh</button>
            <input name="symbols" id="symbols" type="text" size="16" class="symbols"/>
        </form>

        <div class="tiker_table" id="table">

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>BNB</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$300</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>ETH</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$20</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>BTC</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$500</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>ID</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$5</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>ARB</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$40</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>DOGE</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$0.5</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>SOL</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$1</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>ADA</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$15</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>MATIC</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$66</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

            <div class="tiker">
                <div class="tiker_name tiker_params">
                    <p>SHIB</p>
                </div>
                <div class="tiker_price tiker_params">
                    <p>$44</p>
                </div>
                <div class="subscribe_button tiker_params">
                    <a href="#">subscribe</a>
                </div>
            </div>

        </div>

    </main>
</body>

</html>